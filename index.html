<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Bookmarklet OTP Info GTK</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f6f9; padding: 20px; }
    .container { max-width: 700px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #2c3e50; }
    input, button { width: 100%; padding: 12px; margin: 10px 0; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #3498db; color: white; font-weight: bold; cursor: pointer; }
    button:hover { background: #2980b9; }
    #bookmarkletLink { display: block; margin-top: 15px; font-weight: bold; }
</style>
</head>
<body>
<div class="container">
    <h1>ðŸ”‘ Generator Bookmarklet OTP Info GTK</h1>
    <p>Masukkan <b>Secret Key</b> dari Google Authenticator lalu klik tombol untuk membuat bookmarklet.  
       Setelah itu seret link bookmarklet ke bookmark bar browser Anda.</p>
    
    <input type="text" id="secret" placeholder="Masukkan Secret Key (mis: JBSWY3DPEHPK3PXP)">
    <input type="text" id="nama" placeholder="Masukkan Nama Bookmarklet (mis: OTP Info GTK)">
    <button onclick="generate()">Generate Bookmarklet</button>
    
    <a id="bookmarkletLink" href="#" target="_blank"></a>
</div>

<script>
function generate() {
    const secret = document.getElementById("secret").value.trim();
    const nama = document.getElementById("nama").value.trim();
    if (!secret || !nama) {
        alert("Harap isi Secret Key dan Nama Bookmarklet!");
        return;
    }

    const jsCode = `
(function(){
  var secretKey="${secret}";

  function base32Decode(e){for(var t=e.toUpperCase().replace(/=+$/,"").replace(/\\s+/g,""),r=0,n=0,a=[],o=0;o<t.length;o++){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t[o]);if(-1===c)throw new Error("Invalid Base32 character: "+t[o]);n=n<<5|c,(r+=5)>=8&&(a.push(n>>>r-8&255),r-=8)}return new Uint8Array(a)}
  function intToBuffer(e){var t=new ArrayBuffer(8),r=new DataView(t),n=Math.floor(e/Math.pow(2,32)),a=e>>>0;return r.setUint32(0,n),r.setUint32(4,a),new Uint8Array(t)}
  function generateTOTP(e,t,r,n){t=t||6,r=r||30,n=n||"SHA-1";var a=base32Decode(e),o=Math.floor(Date.now()/1e3),c=intToBuffer(Math.floor(o/r));return crypto.subtle.importKey("raw",a,{name:"HMAC",hash:{name:n}},!1,["sign"]).then(function(e){return crypto.subtle.sign("HMAC",e,c)}).then(function(e){var r=new Uint8Array(e),n=15&r[r.length-1];return(((127&r[n])<<24|(255&r[n+1])<<16|(255&r[n+2])<<8|255&r[n+3])%Math.pow(10,t)).toString().padStart(t,"0")})}

  generateTOTP(secretKey).then(function(otp){
    var inputs=document.querySelectorAll(".otp-input");
    if(!inputs||inputs.length!==6){alert("Input OTP tidak ditemukan di halaman ini!");return;}
    for(var i=0;i<6;i++){
      inputs[i].value=otp[i];
      inputs[i].dispatchEvent(new Event("input",{bubbles:true}));
    }
    console.log("âœ… OTP otomatis diisi:",otp);
  }).catch(function(err){alert("Gagal generate OTP: "+err.message);});
})();`;

    const bookmarklet = "javascript:" + encodeURIComponent(jsCode);
    const link = document.getElementById("bookmarkletLink");
    link.href = bookmarklet;
    link.textContent = "ðŸ“Œ " + nama;
    alert("Bookmarklet berhasil dibuat! Seret link di bawah ke bookmark bar browser Anda.");
}
</script>
</body>
</html>
