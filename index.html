javascript:(function(){
  // Secret Base32 hasil ekstrak dari QR
  var secret = "9cf0db1758196087789";

  // Base32 decode
  function base32tohex(base32) {
    var base32chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
    var bits = "";
    var hex = "";
    for (var i = 0; i < base32.length; i++) {
      var val = base32chars.indexOf(base32.charAt(i).toUpperCase());
      if (val >= 0) {
        bits += ("00000" + val.toString(2)).slice(-5);
      }
    }
    for (var j = 0; j + 4 <= bits.length; j += 4) {
      var chunk = bits.substr(j, 4);
      hex = hex + parseInt(chunk, 2).toString(16);
    }
    return hex;
  }

  // HMAC-SHA1
  function hex2dec(s) { return parseInt(s, 16); }
  function leftpad(str, len, pad){ return new Array(len-str.length+1).join(pad)+str; }
  function dec2hex(s){ return (s<15.5?"0":"")+Math.round(s).toString(16); }
  function hex2bytes(hex){
    var bytes=[];
    for(var c=0;c<hex.length;c+=2)
      bytes.push(parseInt(hex.substr(c,2),16));
    return bytes;
  }

  function generateTOTP(secret){
    var epoch = Math.round(new Date().getTime() / 1000.0);
    var time = leftpad(dec2hex(Math.floor(epoch / 30)),16,"0");

    var shaObj = new jsSHA("SHA-1","HEX");
    shaObj.setHMACKey(base32tohex(secret),"HEX");
    shaObj.update(time);
    var hmac = shaObj.getHMAC("HEX");

    var offset = hex2dec(hmac.substring(hmac.length - 1));
    var otp = (hex2dec(hmac.substr(offset*2,8)) & hex2dec("7fffffff")) + "";
    otp = otp.substr(otp.length - 6, 6);
    return otp;
  }

  // Inject jsSHA jika belum ada
  function withJsSHA(callback){
    if(typeof jsSHA==="undefined"){
      var s=document.createElement("script");
      s.src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/2.3.1/sha.js";
      s.onload=callback;
      document.body.appendChild(s);
    } else {
      callback();
    }
  }

  withJsSHA(function(){
    var otp = generateTOTP(secret);
    console.log("OTP:", otp);

    // Cari input OTP di Info GTK
    var inputs=document.querySelectorAll("#otpForm .otp-input");
    if(inputs && inputs.length==6){
      for(var i=0;i<6;i++){
        inputs[i].value=otp[i];
        inputs[i].dispatchEvent(new Event("input",{bubbles:true}));
      }
      // Klik tombol konfirmasi otomatis
      var btn=document.querySelector("button.btn.btn-primary.mt-3");
      if(btn) setTimeout(()=>btn.click(),500);
    } else {
      alert("‚ùå Input OTP Info GTK tidak ditemukan!");
    }
  });
})();
